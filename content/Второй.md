---
title: второй
---
# Билет
Работа с HTTP в Java - веб-сервер, сервер приложений, контейнер сервлетов, сервлеты (логика работы, жизненный цикл сервлета, методы HttpServlet), фильтры, слушатели (ServletContextListener и др.), структура war-архива приложения на сервлетах, конфигурация веб-приложения (web.xml и аннотации), сессии, контекст, внутреннее перенаправление

# Веб-сервер
Сервер, принимающий HTTP-запросы от клиентов и выдающий им HTTP-ответы, вместе с HTML-страницей, изображением, файлом, медиа-потоком или другими данными

# Сервер приложений
Это полная реализация всех спецификаций стандарта JavaEE: распределенные транзакции, EJB, пуллинг соединений к БД и т.д.. Используется для хостинга полноценных enterprise-приложений (.ear)

В случае Java-сервера приложений сервер приложений ведёт себя как расширенная виртуальная машина для запуска приложений, прозрачно управляя соединениями с базой данных, с одной стороны, и соединениями с веб-клиентом, с другой

Примеры – JBoss, TomEE, Glassfish, WebSphere

# Контейнер сервлетов
Это реализация минимальной необходимой части JavaEE – Servlet API и JSP. Умеет хостить статический контент, jsp-страницы и выполнять Java код сервлетов. Остальные спецификации JavaEE при необходимости добавляются сторонними библиотеками-реализациями

Примеры – Tomcat, Jetty

# Сервлеты
## Определение
**Сервлеты Java** — это классы, которые реализуют интерфейс javax.servlet.Servlet, умеют принимать запросы от клиента и возвращать ему ответы. С помощью сервлетов строится клиент-серверная архитектура

```java
package javax.servlet;

public interface Servlet {
	void init(ServletConfig var1) throws ServletException;
	void service(ServletRequest var1, ServletResponse var2) throws ServletException;
	void destroy();
}
```

## Методы
- init(...) - вызывается при загрузке сервлета в контейнер сервлетов(Tomcat)
- service(request, response) - вызывается при необходимости выполнить именно данный сервлет для обработки запроса
	- данные запроса берем из request
	- результат пишем в response
- destroy() - вызывается при удалении сервлета из контейнера сервлетов(Tomcat)

## Жизненный цикл
- До начала обслуживания запросов(если сервлет еще ни разу не загружался):
	- Tomcat загружает класс сервлета
	- Tomcat создает экземпляр класса сервлета
	- Tomcat вызывает метод init() сервлета
- Обслуживание запросов:
	- Tomcat получает запрос, определяет, какой сервлет использовать и вызывает у него service(...).
	- Каждый запрос обслуживается в отдельном потоке.
- Изъятие сервлета из эксплуатации
	- Tomcat вызывает метод destroy().

# HttpServlet
## Методы
- doGet (HttpServletRequest req, HttpServletResponse resp)
- doPost (HttpServletRequest req, HttpServletResponse resp) 
- doPut (HttpServletRequest req, HttpServletResponse resp) 
- doDelete (HttpServletRequest req, HttpServletResponse resp) 
- doOptions (HttpServletRequest req, HttpServletResponse resp) 
- doHead (HttpServletRequest req, HttpServletResponse resp) 

## Пример
```java
@WebServlet(“/main”)
public class TestServlet extends HttpServlet {
	protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { 
		PrintWriter out = resp.getWriter();
		out.println(“Hello world”); 
	}
	
	protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
		String login = req.getParameter(“login”); 
		resp.getWriter().println(“Data is processed”); 
	}
}
```

# Фильтры
## Определение
Фильтры перехватывают запрос и обрабатывает его перед тем, как он попадет к сервлету, а также могут влиять и на ответ. 

зачем нужны? - фильтрация вводимых данных, сжатие данных, пользовательская аутентификация.

## Пример
```java
public class FilterConnect implements Filter { 
	public void doFilter (ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException { 
		if (request.getParameter("username") != null) {
			chain.doFilter(request, response); 
		} 
	} 
}
```

> чуть подзаебала эта тема, потом продолжу