---
title: девятый
---
# Билет
Сетевые приложения. Сокеты и Datagram* в Java. Java NIO (каналы, буферы, селекторы) для сетевых приложений. Общение между программами через сеть, создание своего протокола. Модель OSI (примеры протоколов/семейств/технологий всех уровней). Основные идеи IP, TCP, UDP. Что такое интернет, веб. Порт, доменное имя, DNS, URI, URL-encoding. 

# Сетевые приложения
Сетевые приложения - это программы, которые работают в сетевой среде и обеспечивают взаимодействие между различными устройствами и пользователями. Они используют сетевые протоколы для передачи данных и обмена информацией между клиентом и сервером. Примеры сетевых приложений включают веб-браузеры, электронную почту, мессенджеры, социальные сети, онлайн-игры и многие другие. Сетевые приложения обеспечивают удобный доступ к информации и позволяют пользователям общаться и работать в режиме реального времени в любой точке мира, где есть доступ к Интернету.

# Сокеты и Datagram* в Java
Сокеты и Datagram в Java - это механизмы для обмена данными между двумя узлами (компьютерами) в сети. 

Сокеты используются для передачи потоковых данных, то есть данных, которые необходимо передавать в непрерывном потоке. Сокеты могут быть созданы как на стороне сервера, так и на стороне клиента. Серверный сокет ожидает подключения от клиентского сокета, после чего устанавливается соединение между ними. Клиентский сокет устанавливает соединение с серверным сокетом и отправляет ему данные. 

Datagram используется для передачи датаграмм, то есть небольших пакетов данных, которые могут быть отправлены в любой момент времени. Datagram не устанавливает соединение между узлами, а просто отправляет данные на указанный адрес и порт. 

В Java для работы с сокетами и Datagram используются классы Socket, ServerSocket, DatagramSocket и DatagramPacket. Для передачи данных по сокетам используются потоки ввода-вывода.

# Java NIO (каналы, буферы, селекторы) для сетевых приложений
Java NIO (New Input/Output) - это альтернативная модель ввода/вывода в Java, предназначенная для обработки большого количества одновременных соединений в сетевых приложений.

Основными компонентами Java NIO являются каналы, буферы и селекторы:
1. Каналы (Channels) представляют собой абстракцию низкоуровневых потоков передачи данных, таких как сокеты TCP или файлы. Каналы могут быть либо устройствами ввода, либо устройствами вывода.
2. Буферы (Buffers) используются для временного хранения данных перед их обменом между каналами. Буферы представляют собой простые массивы, которые могут быть использованы для чтения данных из канала или записи в канал.
3. Селекторы (Selectors) позволяют одному потоку обрабатывать несколько каналов. Селекторы представляют собой общий ресурс, к которому регистрируются каналы. По запросу селектора при наличии готовых данных в канале, соответствующему селектору, поток может обработать данные без блокировки.

С помощью Java NIO можно создавать высокопроизводительные сетевые приложения, такие как серверы и клиенты. Эта модель позволяет обрабатывать множество соединений одновременно с помощью одного потока, что уменьшает нагрузку на систему и повышает производительность.

# Общение между программами через сеть, создание своего протокола


# Модель OSI (примеры протоколов/семейств/технологий всех уровней)
**Модель OSI (Open System Interconnection)**, или эталонная модель взаимодействия открытых систем описывает, как устройства в локальных и глобальных сетях обмениваются данными и что происходит с этими данными. Её предложили в 1984 году инженеры из Международной организации по стандартизации (ISO), которая работала над единым стандартом передачи данных по интернету.

Модель OSI включает семь слоёв, или уровней, — причём каждый из них выполняет определённую функцию: например, передать данные или представить их в понятном для человека виде на компьютере. Кстати, у каждого слоя — свой набор протоколов.

Самый нижний слой отвечает за физическое представление данных, то есть за то, как данные передаются по проводам или с помощью радиоволн, а самый верхний — за то, как приложения взаимодействуют с сетью.

## 1-й уровень OSI — физический 
На самом нижнем уровне модели OSI данные представляют собой физические объекты — ток, свет или радиоволны. Они передаются по проводам или с помощью беспроводных сигналов.

Этот слой работает с кабелями, контактами в разъёмах, модуляцией сигнала, кодированием единиц и нулей и другими низкоуровневыми штуками. По сути, первый уровень — это уровень проводов и физических способов передачи сигнала. Минимальная абстракция.

Самый известный протокол на физическом уровне — Ethernet. Он описывает, как сигналы кодируются и передаются по проводам. Кроме него есть Bluetooth, Wi-Fi и ИК-порт, которые также содержат инструкции для передачи данных.

Устройства физического уровня — концентраторы и репитеры. Они работают с физическим сигналом «втупую» и не вникают в его логику: получили данные — передали их дальше по проводу.

## 2-й уровень OSI — канальный  
Над физическим уровнем располагается канальный. Его задача — проверить целостность полученных данных и исправить ошибки. Этот уровень «поумнее» предыдущего: он уже понимает, что разные амплитуды напряжений отвечают разным битам — нулям и единицам. А ещё канальный уровень умеет кодировать сигналы в биты и передавать их дальше.

Полученные с нижнего уровня данные делятся на фреймы, или кадры. Каждый фрейм состоит из служебной информации — например, адреса отправителя и адреса получателя, — а также самих данных.

Получается что-то вроде почтового конверта. На лицевой стороне у него написано, от кого пришло письмо, а внутри находится само письмо (в нашем случае данные).

Лицевая сторона конверта — это MAC-адрес устройства, которое отправило нам информацию. Он нужен, чтобы идентифицировать устройства в локальной сети, состоит из 48 или 64 бит и выглядит примерно так:
![](https://skillbox.ru/upload/setka_images/12534401092022_ff777f213e3cf3fe8a40b34db3773616a4292812.png)

## 3-й уровень OSI — сетевой  
Этот уровень отвечает за маршрутизацию данных внутри сети между компьютерами. Здесь уже появляются такие термины, как «маршрутизаторы» и «IP-адреса».

Маршрутизаторы позволяют разным сетям общаться друг с другом: они используют MAC-адреса, чтобы построить путь от одного устройства к другому.

Данные на сетевом уровне представляются в виде пакетов. Такие пакеты похожи на фреймы из канального уровня, но используют другие адреса получателя и отправителя — IP-адреса.

Чтобы получить IP-адрес обоих устройств (отправителя и получателя), существует протокол ARP (address resolution protocol). Он умеет конвертировать MAC- в IP-адрес и наоборот.
## 4-й уровень OSI — транспортный
Из названия понятно, что на этом уровне происходит передача данных по сети. Так и есть. Два главных протокола здесь — TCP и UDP. Они как раз и отвечают за то, как именно будут передаваться данные.

TCP (Transmission Control Protocol) — это протокол, который гарантирует доставку данных в корректном виде. Он жёстко следит за каждым битом информации, но работает гораздо медленнее UDP.

Например, когда вы вводите логин и пароль при входе в социальную сеть, очень важно, чтобы все символы отправились в определённой последовательности. Если какие-то потеряются или изменятся, вы просто не сможете авторизоваться. Поэтому протокол TCP использует разные методы проверок — например, контрольные суммы.

А вот в видео или аудио небольшие потери некритичны, зато важна скорость передачи данных. Для таких задач как раз и придумали протокол UDP (user datagram protocol). Он уже не проверяет цельность битов, его задача — как можно быстрее передать данные с одного устройства на другое.

В протоколе TCP данные делятся на сегменты. Каждый сегмент — часть пакета. Сегменты нужны, чтобы передавать информацию по сети, учитывая её пропускную способность.

Ещё сегментация важна для надёжности. Один большой пакет может потеряться или направиться не тому адресату. А маленькие пакеты снижают риск подобных ошибок и даже позволяют проверять их количество. Если какой-то сегмент не получилось доставить, протокол TCP может запросить его у отправителя снова. Так обеспечивается надёжность.

В UDP данные делятся на датаграммы — это примерно то же, что и пакет, только датаграммы автономны. Каждая датаграмма имеет всё необходимое, чтобы дойти до получателя. Поэтому они не зависят от сети и могут доставляться по разным маршрутам и в произвольном порядке.

## 5-й уровень OSI — сеансовый  
Начиная с этого уровня и выше, данные имеют уже нормальный вид — например, привычных нам JPEG- или MP3-файлов. Задача сети на этих уровнях — представить информацию в понятном для человека виде и сделать так, чтобы пользователь мог её как-то «потрогать».

Сеансовый уровень управляет соединениями, или сессиями. Типичный пример — звонок по Skype или Zoom. Когда вы звоните другому человеку, между вашими компьютерами устанавливается соединение, по которому передаются аудио и видео. Если такое соединение разорвать, то и ваш звонок прервётся.

На сеансовом уровне очень важно, чтобы соединение правильно установилось и поддерживалось. То есть механизмы протоколов должны проверить, что у обоих собеседников есть нужные кодеки и сигнал между устройствами присутствует.
## 6-й уровень OSI — уровень представления данных  
На этом уровне происходит преобразование форматов данных — их кодирование и сжатие. Например, полученные данные могут превратиться в GIF- или MP4-файл. То же самое происходит и в обратном порядке: когда пользователь отправляет файл другому человеку, данные сначала конвертируются в биты и сжимаются, а потом уже передаются на транспортный уровень.

Помимо кодировки и сжатия на уровне представления, данные могут шифроваться — если, конечно, это необходимо.
## **7-й уровень OSI — прикладной**  
Последний уровень модели OSI — прикладной. На нём находятся сетевые службы, которые помогают без проблем сёрфить в интернете.

Прикладной уровень похож на некий графический интерфейс для всей модели OSI — с его помощью пользователь взаимодействует с другими уровнями, даже не подозревая об этом. Этот интерфейс называется сетевым.

Самые популярные из сетевых интерфейсов — это HTTP, HTTPS, FTP, SMTP  А «устройства» здесь — это уже программы: Zoom, Telegram, браузеры.
## Как на практике работает сетевая модель OSI
Мы хотим отправить сообщение нашему другу. Печатаем текст и нажимает кнопку «Отправить», а дальше перемещаемся внутрь компьютера.

**Прикладной уровень.** Приложение Telegram работает на прикладном уровне модели OSI. Когда мы печатаем текст сообщения и нажимаем кнопку «Отправить», эти данные передаются на сервер мессенджера, а оттуда — нашему другу.

Весь процесс проходит через API разных библиотек — например, для HTTP-запросов. Интерфейсы позволяют без лишних проблем обмениваться данными и не погружаться в то, как они представлены на низком уровне. Всё, что нужно знать, — это какую функцию вызвать и какие переменные туда передать.

**Уровень представления.** Здесь данные должны преобразоваться в унифицированный формат, чтобы их можно было передавать на разные устройства и операционные системы. Например, если мы отправляем сообщение c Windows на macOS, данные должны быть в читаемом для компьютеров Apple виде. Такая же ситуация и с другими устройствами.

Раз мы собираемся передать данные на другой компьютер, их нужно перевести в бинарный формат. После этого начнётся сам процесс передачи по сети.

**Сеансовый уровень.** Чтобы данные успешно передались сначала на сервер Telegram, а затем к нашему другу, приложению нужно установить соединение, или сеанс. Он обеспечивает синхронизацию между устройствами и восстанавливает связь, если она прервалась.

Благодаря сеансам вы можете видеть, что собеседник что-то печатает или отправляет вам картинки или видео. Но главная задача этого соединения — обеспечить стабильное соединение для передачи данных.

**Транспортный уровень.** Когда соединение установлено и данные унифицированы, пора передавать их. Этим занимается транспортный уровень.

Здесь данные разбиваются на сегменты и к ним добавляется дополнительная информация — например, номер порта и контрольные суммы. Всё это нужно, чтобы данные дошли до пользователя в целостности.

**Сетевой уровень.** Теперь данным нужно найти маршрут к устройству нашего друга, а затем отправить их по нему. Поэтому данные упаковываются в пакеты и к ним добавляются IP-адреса.

Чтобы получить IP-адрес устройств, которым нужно отправить пакеты, маршрутизаторы (устройства сетевого уровня) обращаются к ARP. Этот протокол быстро найдёт адрес получателя и отдаст его нам.

**Канальный уровень.** Здесь данные передаются от одного MAC-адреса к другому. Изначальный текст делится на фреймы — с заголовками и контрольными суммами для проверки целостности данных.

**Физический уровень.** И на самом нижнем уровне данные в виде электрических сигналов передаются по проводам, кабелям или по радиоволнам. Тут только одна задача — как можно быстрее откликаться на сигналы свыше.

После прохождения всех уровней модели OSI сообщение успешно доставляется на устройство нашего друга. Правда, в реальности это занимает всего миллисекунды.






# Порт
Порт - целое неотрицательное число, записываемое в заголовках протоколов транспортного уровня модели OSI (TCP, UDP, SCTP, DCCP).
Порты выдает ОС. Нужны для одновременного выполнения нескольких программ, каждая из которых использует сеть. Для обмена данными нужны два порта - отправитель, получатель.

Диапазон 0-65535. Примеры:
- 80 HTTP
- 8080 HTTP (альтернативный)
- 20/21 FTP
- 22 SSH
- 143 IMAP
- 443 HTTPS (SSL/TLS)
- 3306 MySQL
- 5432 PostgreSQL
# URI, URL, URN
- **URI** - это **URL + URN**
- **URL** – адрес ресурса в сети, определяет местонахождение и способ обращения к нему
- **URN** – имя ресурса в сети, определяет только название ресурса, но не говорит как к нему подключиться

Пример:
- `https://lldan.ru` - **URL**
- `/poshla-voda` - **URN**
- `https://lldan.ru/poshla-voda` - **URI**

# URL-encoding
URL адреса могут быть отправлены только через интернет ASCII символьный набор. Если URL адрес содержит символы, не входящие в набор ASCII, URL адрес должен быть преобразован, согласно таблице кодировки.

Кодирование URL заменяет не ASCII символы с "%", за которым следуют шестнадцатеричные цифры.

URL-адрес не может содержать пробелы. Кодировки URL-адреса, как правило, заменяет пространство со знаком плюс (+), или %20.

Поэтому ссылка `https://oris.lldan.ru/Восьмой` выглядит так `https://oris.lldan.ru/%D0%92%D0%BE%D1%81%D1%8C%D0%BC%D0%BE%D0%B9`
